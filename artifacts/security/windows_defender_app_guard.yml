title: "Windows Defender Application Guard"
category: "security"
description: "Application Guard isolation, virtualization settings, and enterprise security configuration"

paths:
  - "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WindowsApplicationGuard"
  - "HKLM\\SOFTWARE\\Policies\\Microsoft\\AppHVSI"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\HvHost"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\msedge.exe"

details:
  what: |
    Windows Defender Application Guard (WDAG) provides hardware-based isolation for
    Microsoft Edge and Office applications using Hyper-V virtualization technology.
    Registry manages isolation policies, virtualization settings, data persistence
    rules, and enterprise configuration for protecting against advanced threats
    through application-level containerization and secure browsing environments.

  forensic_value: |
    Critical for investigating attempts to bypass enterprise security controls,
    reveals configuration changes that could weaken isolation protections, shows
    evidence of sophisticated attacks targeting virtualized environments, and
    indicates potential security policy violations. Can reveal attempts to disable
    security features or evidence of advanced persistent threats targeting
    enterprise browser security mechanisms.

  structure: |
    WindowsApplicationGuard contains feature enablement settings, isolation policies,
    and data persistence configuration. AppHVSI policy entries control enterprise
    settings for clipboard access, file downloads, printing, and camera/microphone
    usage within isolated environments. Service configuration manages virtualization components.

  examples:
    - "Enabled: 1 (Application Guard enabled)"
    - "AllowPersistence: 0 (Non-persistent mode - data deleted on restart)"
    - "AllowClipboard: 1 (Clipboard access between host and container allowed)"
    - "BlockNonEnterpriseContent: 1 (Block non-enterprise websites)"
    - "CertificateThumbprints: Enterprise certificate validation"
    - "SaveFilesToHost: 0 (File downloads to container only)"

  tools:
    - name: "Windows Features (Turn Windows features on or off)"
      description: "Built-in Windows Application Guard enablement interface"
    - name: "Group Policy Editor"
      description: "Enterprise Application Guard policy configuration"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "Hyper-V Manager"
      description: "Virtualization platform management for Application Guard"

metadata:
  windows_versions:
    - "Windows 10 Enterprise"
    - "Windows 10 Professional"
    - "Windows 11 Enterprise"
    - "Windows 11 Professional"

  introduced: "Windows 10 Anniversary Update (1607)"
  
  criticality: "high"

  investigation_types:
    - "incident-response"
    - "insider-threat"

  tags:
    - "application-guard"
    - "isolation"
    - "virtualization"
    - "edge-security"
    - "enterprise-protection"
    - "hyper-v"
    - "containerization"

  references:
    - title: "Windows Defender Application Guard Documentation"
      url: "https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-application-guard/"
      type: "official"
    - title: "Application Guard Enterprise Configuration"
      url: "https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-application-guard/configure-md-app-guard"
      type: "official"

  retention:
    default_location: "Registry hive files (SOFTWARE, SYSTEM)"
    persistence: "Configuration persists until administratively changed"
    volatility: "Critical enterprise security configuration affecting threat protection"

  related_artifacts:
    - "windows_defender"
    - "virtualization_settings"
    - "enterprise_security"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-06-08"
  last_updated: "2025-06-08"
  version: "1.0"
