title: "Windows Firewall Advanced Rules and Exceptions"
category: "security"
description: "Detailed firewall rules, port exceptions, application permissions, and network security policies"

paths:
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\FirewallRules"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile"

details:
  what: |
    Windows Firewall Advanced Rules manage granular network traffic control including
    application-specific permissions, port exceptions, protocol filtering, and profile-based
    security policies. Registry stores detailed rule configurations, inbound/outbound
    traffic permissions, network location-based profiles, and exception lists for
    comprehensive network security management and threat protection.

  forensic_value: |
    Critical for investigating network-based attacks, unauthorized network access,
    and malware communication attempts. Shows evidence of firewall rule modifications
    that could enable data exfiltration, reveals custom exceptions that bypass security,
    and indicates sophisticated attacks that modify network security policies.
    Essential for analyzing network security bypasses and unauthorized communications.

  structure: |
    FirewallRules contain pipe-delimited rule definitions including direction (In/Out),
    action (Allow/Block), protocol, local/remote ports, application paths, and profiles.
    Profile-specific configurations control firewall behavior for domain, private,
    and public networks with different security postures and rule enforcement levels.

  examples:
    - "Rule: v2.25|Action=Allow|Active=TRUE|Dir=In|Protocol=6|LPort=80|App=C:\\Program Files\\App\\app.exe"
    - "Rule: v2.25|Action=Block|Active=TRUE|Dir=Out|Protocol=17|RPort=53|RA=8.8.8.8"
    - "DomainProfile\\EnableFirewall: 1 (Domain firewall enabled)"
    - "PublicProfile\\EnableFirewall: 0 (Public firewall disabled - risk)"
    - "StandardProfile\\DefaultInboundAction: 1 (Block inbound by default)"
    - "FirewallRules\\{GUID}: Malware exception rule (Suspicious custom rule)"

  tools:
    - name: "Windows Defender Firewall (wf.msc)"
      description: "Built-in Windows firewall configuration and rule management"
    - name: "netsh advfirewall"
      description: "Command-line firewall configuration and rule export/import"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "Windows Firewall Analysis Tools"
      description: "Third-party tools for firewall rule analysis and audit"

metadata:
  windows_versions:
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"

  introduced: "Windows Vista (Advanced Firewall)"
  
  criticality: "high"

  investigation_types:
    - "malware-analysis"
    - "incident-response"
    - "behavioral-analysis"

  tags:
    - "firewall"
    - "network-security"
    - "port-exceptions"
    - "network-rules"
    - "malware-communication"
    - "security-bypass"

  references:
    - title: "Windows Firewall with Advanced Security"
      url: "https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-firewall/"
      type: "official"

  retention:
    default_location: "Registry hive files (SYSTEM)"
    persistence: "Firewall rules persist until manually removed or policy changes"
    volatility: "Network security configuration affecting ongoing threat protection"

  related_artifacts:
    - "network_connections"
    - "security_policies"
    - "malware_communication"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-06-08"
  last_updated: "2025-06-08"
  version: "1.0"
