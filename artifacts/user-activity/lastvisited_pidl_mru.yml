title: "Last Visited Folder MRU (PidlMRU)"
category: "user-activity"
description: "Last visited folders in file dialogs with executable name associations and application correlation"

paths:
  - "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\LastVisitedPidlMRU"
  - "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\LastVisitedMRU"

details:
  what: |
    Windows tracks the last visited folders when applications use standard file
    dialog boxes, along with the executable name that opened each folder location.
    Shows detailed folder navigation patterns, application-specific file access,
    and correlates specific programs with folder locations they accessed. Maintains
    chronological order of folder visits with associated application context.

  forensic_value: |
    Links specific applications to folder locations they accessed, shows user
    navigation patterns, reveals attempts to access restricted areas, and can
    indicate data staging, reconnaissance activities, or exfiltration preparation.
    Critical for proving application-specific folder access and understanding
    user behavior patterns across different software applications.

  structure: |
    Sequential entries containing executable name followed by folder path data
    in binary PIDL (Pointer to Item IDentifier List) format. MRUListEx shows
    access order with most recent first. Each entry links a specific program
    to the folder location it accessed, providing application context for
    folder navigation activities.

  examples:
    - "Entry 0: notepad.exe -> C:\\Users\\user\\Documents\\Sensitive"
    - "Entry 1: winrar.exe -> \\\\server\\confidential\\archives"
    - "Entry 2: cmd.exe -> C:\\Windows\\System32"
    - "Entry 3: malware.exe -> C:\\Temp\\Staging"
    - "Entry 4: excel.exe -> \\\\fileserver\\finance\\reports"
    - "MRUListEx: 4,3,2,1,0 (most recent access order)"
    - "Network access: powershell.exe -> \\\\192.168.1.100\\admin$"
    - "USB access: explorer.exe -> E:\\USB_Drive\\confidential"

  tools:
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry browser with PIDL MRU parsing and application correlation"
    - name: "LastActivityView"
      url: "https://www.nirsoft.net/utils/computer_activity_view.html"
      description: "Comprehensive computer activity viewer including folder access patterns"
    - name: "RegRipper"
      url: "https://github.com/keydet89/RegRipper3.0"
      description: "Registry analysis with lastvisitedmru.pl plugin for detailed parsing"
    - name: "PIDL Analyzer"
      description: "Specialized tools for analyzing PIDL data structures and folder paths"
    - name: "MRU Analysis Toolkit"
      description: "Comprehensive MRU analysis tools including LastVisited parsing"

metadata:
  windows_versions:
    - "Windows XP"
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"
    - "Windows Server 2003"
    - "Windows Server 2008"
    - "Windows Server 2012"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows XP"
  
  criticality: "high"

  investigation_types:
    - "data-exfiltration"
    - "insider-threat"
    - "behavioral-analysis"
    - "timeline-analysis"
    - "incident-response"

  tags:
    - "user-activity"
    - "folder-access"
    - "application-tracking"
    - "navigation-patterns"
    - "data-staging"
    - "file-dialogs"
    - "program-correlation"
    - "reconnaissance"
    - "folder-navigation"

  references:
    - title: "Common Dialog Box Library"
      url: "https://docs.microsoft.com/en-us/windows/win32/dlgbox/common-dialog-box-library"
      type: "official"
    - title: "PIDL (Pointer to Item IDentifier List)"
      url: "https://docs.microsoft.com/en-us/windows/win32/shell/objects"
      type: "official"
    - title: "Windows Dialog History Forensics"
      url: "https://www.sans.org/blog/windows-dialog-history-analysis/"
      type: "research"
    - title: "MRU Analysis in Digital Forensics"
      url: "https://www.forensicfocus.com/articles/mru-lists-analysis/"
      type: "research"

  retention:
    default_location: "NTUSER.DAT registry hive"
    persistence: "Survives file deletion and application uninstallation, persists per user profile"
    volatility: "Limited cache size may cause older entries to be overwritten"

  related_artifacts:
    - "opensavemru"
    - "shellbags"
    - "recent_docs"
    - "comdlg32_settings"
    - "office_files"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"