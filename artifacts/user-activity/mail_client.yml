title: "Email Client Registry Configuration"
category: "user-activity"
description: "Email client settings, MAPI configuration, default mail applications, and messaging protocols"

paths:
  - "HKCU\\Software\\Microsoft\\Office\\Outlook"
  - "HKCU\\Software\\Microsoft\\Windows Mail"
  - "HKCU\\Software\\Clients\\Mail"
  - "HKLM\\SOFTWARE\\Clients\\Mail"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows Messaging Subsystem"

details:
  what: |
    Email client configuration encompasses default mail client registration, MAPI (Messaging
    Application Programming Interface) settings, account configuration remnants, mail client
    preferences, protocol associations, and messaging subsystem configuration. Controls email
    handling behavior, client integration, protocol support, and system-wide messaging
    functionality for comprehensive email communication management.

  forensic_value: |
    Critical for investigating email-based attacks, data exfiltration through email channels,
    and communication pattern analysis. Shows email client usage indicating potential corporate
    espionage, reveals mail client modifications that facilitate email interception, and provides
    evidence of email-based command and control communication. Essential for understanding
    email infrastructure used for malicious activities and insider threat investigations.

  structure: |
    Mail client registration includes default client specification, protocol associations for
    mailto: links, MAPI provider configuration, and client-specific settings. MAPI configuration
    controls messaging API behavior, profile settings, and service provider integration.
    Client preferences include server settings, security configurations, and user interface
    customizations stored as various registry data types.

  examples:
    - "Default Mail Client: Microsoft Outlook (Configured default email application)"
    - "mailto\\shell\\open\\command: \"C:\\Program Files\\Microsoft Office\\OUTLOOK.EXE\" -c IPM.Note /m \"%1\""
    - "MAPI\\CMC: 1 (Common Messaging Calls interface enabled)"
    - "MAPI\\CMCDLLNAME32: mapi32.dll (32-bit MAPI library)"
    - "Outlook\\Profiles\\Outlook: Default mail profile configuration"
    - "AutoConfigURL: https://autodiscover.company.com/autodiscover/autodiscover.xml"
    - "SuspiciousClient: C:\\malware\\email-stealer.exe (Unauthorized mail client)"

  tools:
    - name: "Default Programs Control Panel"
      description: "Windows built-in default application configuration interface"
    - name: "Mail Control Panel (32-bit)"
      description: "MAPI profile and email account management utility"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "MAPI Configuration Analyzer"
      description: "Third-party tools for analyzing MAPI and email client settings"
    - name: "Email Client Forensics Tools"
      description: "Specialized utilities for email client configuration analysis"

metadata:
  windows_versions:
    - "Windows 95"
    - "Windows NT"
    - "Windows XP"
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"

  introduced: "Windows 95"

  criticality: "medium"

  investigation_types:
    - "data-exfiltration"
    - "insider-threat"
    - "malware-analysis"
    - "incident-response"

  tags:
    - "email"
    - "mail-client"
    - "mapi"
    - "default-applications"
    - "communication"
    - "messaging"
    - "protocols"

  references:
    - title: "Microsoft Documentation: MAPI"
      url: "https://docs.microsoft.com/en-us/office/client-developer/outlook/mapi/mapi-reference"
      type: "official"
    - title: "Email Client Forensics and Investigation"
      url: "https://www.forensicfocus.com/articles/email-client-forensics/"
      type: "research"

  retention:
    default_location: "Registry hive files (SOFTWARE, NTUSER.DAT)"
    persistence: "Email configuration persists until manually changed"
    volatility: "Client settings affect ongoing email communication capabilities"

  related_artifacts:
    - "default_applications"
    - "user_profiles"
    - "network_connections"
    - "certificate_stores"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"
