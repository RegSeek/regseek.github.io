title: "Malware Quarantine and Detection History"
category: "security-monitoring"
description: "Anti-malware quarantine locations, detection history, threat signatures, and security incident tracking"

paths:
  - "HKLM\\SOFTWARE\\Microsoft\\Microsoft Antimalware\\Quarantine"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Quarantine"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Threats\\ThreatIDDefaultAction"
  - "HKLM\\SOFTWARE\\Microsoft\\RemovalTools\\MpSigStub"

details:
  what: |
    Windows anti-malware quarantine system maintains records of detected threats, quarantined files, 
    malware signatures, threat classifications, and detection timestamps. Manages isolated malicious 
    files and automatic response actions for endpoint protection.

  forensic_value: |
    Shows evidence of malware detection, quarantine actions, and threat persistence attempts. Critical 
    for identifying attack campaigns, malware families, and establishing infection timelines. Provides 
    direct evidence of malicious activity and security response effectiveness.

  structure: |
    Quarantine entries contain threat identifiers, file locations, detection timestamps, and threat 
    categories. ThreatIDDefaultAction maps threat identifiers to automatic response behaviors. 
    RemovalTools contains malware removal utility execution history.

  examples:
    - "Quarantine\\{12345678-1234-5678-9abc-123456789abc}: Quarantined malware file"
    - "ThreatName: Trojan:Win32/Emotet.A (Threat classification)"
    - "DetectionTime: 2024-01-15T14:30:25Z (Malware detection timestamp)"
    - "QuarantinePath: C:\\ProgramData\\Microsoft\\Windows Defender\\Quarantine"
    - "ThreatIDDefaultAction\\2147735503: 2 (Automatic quarantine action)"
    - "OriginalPath: C:\\Users\\user\\Downloads\\malware.exe (Original file location)"
    - "ThreatSeverity: 4 (High severity threat level)"
    - "CleaningAction: 3 (File quarantined successfully)"

  tools:
    - name: "Windows Security (ms-settings:windowsdefender)"
      description: "Built-in Windows Defender threat history and quarantine management"
    - name: "MpCmdRun.exe"
      description: "Windows Defender command-line scanner and threat management utility"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "Quarantine File Analyzer"
      description: "Specialized tools for analyzing quarantined malware samples"
    - name: "Threat Intelligence Platform"
      description: "Enterprise threat analysis and malware family identification tools"

limitations:
  - "Quarantine records do NOT prove malware execution or successful compromise"
  - "Detection events may be false positives flagging legitimate software"
  - "Quarantine action doesn't indicate what damage malware may have caused"
  - "Threat signatures can miss advanced or zero-day malware variants"
  - "Detection timestamps show discovery, not initial infection or execution time"
  - "Quarantined files may be inert or caught before becoming active"

correlation:
  required_for_definitive_compromise_proof:
    - "Process execution logs showing malware launch before quarantine"
    - "File system artifacts showing malware activity (files created, modified)"
    - "Network logs showing malicious communication before detection"
    - "Registry modifications made by malware before quarantine"
    - "Event logs showing successful malware execution and system changes"
    
  strengthens_evidence:
    - "AmCache or ShimCache entries showing malware file presence before quarantine"
    - "UserAssist showing user interaction with malware before detection"
    - "Browser downloads or email attachments containing the quarantined malware"
    - "Scheduled tasks or registry persistence mechanisms created by malware"

metadata:
  windows_versions:
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"
    - "Windows Server 2008"
    - "Windows Server 2012"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows Vista"
  criticality: "high"

  investigation_types:
    - "malware-analysis"
    - "incident-response"
    - "timeline-analysis"
    - "behavioral-analysis"
    - "anti-forensics"

  tags:
    - "malware"
    - "quarantine"
    - "threat-detection"
    - "antivirus"
    - "security-incidents"
    - "threat-analysis"
    - "malware-families"
    - "endpoint-protection"

  references:
    - title: "Microsoft Documentation: Windows Defender Antivirus"
      url: "https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-antivirus/"
      type: "official"
    - title: "Malware Analysis and Quarantine Forensics"
      url: "https://www.sans.org/white-papers/37657/"
      type: "research"
    - title: "Windows Defender Threat Intelligence"
      url: "https://www.microsoft.com/en-us/security/business/threat-protection/intelligence"
      type: "official"

  retention:
    default_location: "Registry hive files (SOFTWARE), quarantine storage"
    persistence: "Quarantine records persist until manual cleanup or retention policy expiry"
    volatility: "Threat detection data provides ongoing security incident intelligence"

  related_artifacts:
    - "windows_defender"
    - "security_center"
    - "appcompat_cache"
    - "amcache"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-06-13"
  version: "3.0"
