title: "Local Security Policy Settings"
category: "system"
description: "Security policies, audit settings, access control configuration, and Local Security Authority settings"

paths:
  - "HKLM\\SECURITY\\Policy"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa"
  - "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows"

details:
  what: |
    Local Security Policy configuration encompasses comprehensive audit policies, user rights
    assignments, security options, Local Security Authority (LSA) settings, and system-wide
    security controls. Manages authentication policies, privilege assignments, audit logging
    configuration, password policies, and security restrictions that govern system access
    control and security behavior across Windows environments.

  forensic_value: |
    Critical for detecting security policy modifications that weaken system defenses, shows
    disabled audit logging designed to hide malicious activity, reveals privilege escalation
    attempts through policy changes, and indicates sophisticated attacks that modify security
    controls. Security policy analysis reveals attacker knowledge of Windows security mechanisms
    and attempts to establish persistence or evade detection through policy manipulation.

  structure: |
    Security policy data stored in binary format within SECURITY registry hive containing
    audit policy settings, user rights assignments, and security options. LSA settings
    control authentication mechanisms, credential caching, and security package configurations.
    Policies registry contains user-level security restrictions and Group Policy settings
    that affect security behavior and system restrictions.

  examples:
    - "AuditLogonEvents: 0 (Logon event auditing disabled)"
    - "AuditObjectAccess: 3 (File/folder access auditing enabled for success and failure)"
    - "AuditPrivilegeUse: 2 (Privilege use auditing for failures only)"
    - "LSA\\LimitBlankPasswordUse: 0 (Allow blank passwords for network logon)"
    - "LSA\\NoLMHash: 1 (Disable LM hash storage)"
    - "CrashOnAuditFail: 0 (System continues if audit log full)"
    - "ShutdownWithoutLogon: 1 (Allow shutdown without logon)"
    - "EnableGuestAccount: 0 (Guest account disabled)"

  tools:
    - name: "Local Security Policy (secpol.msc)"
      description: "Built-in Windows security policy management interface"
    - name: "secedit.exe"
      description: "Command-line security configuration and analysis tool"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "Policy Analyzer"
      description: "Third-party tools for security policy assessment and comparison"
    - name: "Group Policy Editor (gpedit.msc)"
      description: "Advanced policy configuration and management interface"
    - name: "auditpol.exe"
      description: "Command-line audit policy configuration utility"

metadata:
  windows_versions:
    - "Windows NT"
    - "Windows 2000"
    - "Windows XP"
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"
    - "Windows Server 2000"
    - "Windows Server 2003"
    - "Windows Server 2008"
    - "Windows Server 2012"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows NT 3.1"

  criticality: "high"

  investigation_types:
    - "privilege-escalation"
    - "behavioral-analysis"
    - "lateral-movement"
    - "incident-response"
    - "lateral-movement"
    
  tags:
    - "security-policy"
    - "audit-settings"
    - "lsa"
    - "access-control"
    - "privilege-escalation"
    - "policy-modification"
    - "security-evasion"

  references:
    - title: "Microsoft Documentation: Local Security Policy"
      url: "https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/"
      type: "official"
    - title: "Windows Security Policy Manipulation"
      url: "https://attack.mitre.org/techniques/T1562/"
      type: "research"

  retention:
    default_location: "Registry hive files (SECURITY, SOFTWARE, SYSTEM)"
    persistence: "Security policies persist until administratively changed"
    volatility: "Critical settings affecting ongoing system security and access control"

  related_artifacts:
    - "sam_security"
    - "audit_settings"
    - "user_profiles"
    - "security_center"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"
