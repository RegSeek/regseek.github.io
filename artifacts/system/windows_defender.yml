title: "Windows Defender and Security Settings"
category: "system"
description: "Windows Defender configuration, exclusions, security policies, and User Account Control settings"

paths:
  - "HKLM\\SOFTWARE\\Microsoft\\Windows Defender"
  - "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions"

details:
  what: |
    Windows Defender (Windows Security) comprehensive configuration including real-time protection
    settings, scan exclusions, threat detection policies, automatic sample submission, cloud
    protection settings, and User Account Control (UAC) configuration. Controls system security
    posture, malware detection capabilities, security notifications, and administrative privilege
    elevation policies essential for endpoint protection and security management.

  forensic_value: |
    Critical for detecting sophisticated evasion techniques where attackers disable security
    features to facilitate malware execution, reveals exclusion paths added by malware to
    avoid detection, and indicates security policy modifications that weaken system defenses.
    Disabled Windows Defender or modified exclusions often indicate compromise, while UAC
    modifications may enable privilege escalation attacks or administrative access bypass
    attempts essential for forensic security assessment.

  structure: |
    Defender configuration includes DisableAntiSpyware (complete disabling), DisableRealtimeMonitoring
    (real-time protection), exclusion lists for paths/processes/extensions, update configurations,
    and cloud protection settings. UAC settings control elevation prompts through ConsentPromptBehaviorAdmin,
    EnableLUA (UAC enablement), and PromptOnSecureDesktop (secure prompt display) with various
    security level configurations for comprehensive protection management.

  examples:
    - "DisableAntiSpyware: 1 (Windows Defender completely disabled)"
    - "DisableRealtimeMonitoring: 1 (Real-time protection disabled)"
    - "Exclusions\\Paths: C:\\Malware, C:\\Tools\\Hacking (Suspicious exclusion paths)"
    - "Exclusions\\Processes: malware.exe, cryptominer.exe (Excluded malicious processes)"
    - "ExclusionExtension: .exe, .dll, .scr (Dangerous extension exclusions)"
    - "EnableLUA: 0 (User Account Control completely disabled)"
    - "ConsentPromptBehaviorAdmin: 0 (No UAC prompts for administrators)"
    - "PromptOnSecureDesktop: 0 (UAC prompts not on secure desktop)"

  tools:
    - name: "Windows Security (ms-settings:windowsdefender)"
      description: "Built-in Windows Security management interface"
    - name: "Get-MpPreference PowerShell"
      description: "PowerShell cmdlets for Windows Defender configuration analysis"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "Group Policy Editor (gpedit.msc)"
      description: "Advanced Windows Defender and UAC policy configuration"
    - name: "Windows Defender Security Center"
      description: "Centralized security status and configuration management"
    - name: "Defender Configuration Analyzer"
      description: "Third-party tools for comprehensive Defender settings assessment"

metadata:
  windows_versions:
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"
    - "Windows Server 2008"
    - "Windows Server 2012"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows Vista (Windows Defender), Windows Vista (UAC)"

  criticality: "high"

  investigation_types:
    - "incident-response"
    - "malware-analysis"
    - "privilege-escalation"

  tags:
    - "windows-defender"
    - "security-policy"
    - "uac"
    - "malware-evasion"
    - "exclusions"
    - "real-time-protection"
    - "endpoint-security"

  references:
    - title: "Microsoft Documentation: Windows Security"
      url: "https://docs.microsoft.com/en-us/windows/security/threat-protection/"
      type: "official"
    - title: "Windows Defender Evasion Techniques"
      url: "https://attack.mitre.org/techniques/T1562/001/"
      type: "research"
    - title: "UAC Bypass Methods and Detection"
      url: "https://attack.mitre.org/techniques/T1548/002/"
      type: "research"

  retention:
    default_location: "Registry hive files (SOFTWARE)"
    persistence: "Security settings persist until manually changed or policy overridden"
    volatility: "Critical security configuration affecting ongoing threat protection"

  related_artifacts:
    - "security_center"
    - "security_policy"
    - "malware_exclusions"
    - "privilege_escalation"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"
