title: "User Accounts and Profile Information"
category: "system"
description: "Complete user account registry data including SIDs, profile paths, account creation timestamps, and user metadata"

paths:
  - "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList"
  - "HKLM\\SAM\\SAM\\Domains\\Account\\Users"
  - "HKLM\\SAM\\SAM\\Domains\\Account\\Users\\Names"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileGuid"

details:
  what: |
    Windows stores comprehensive user account information including Security Identifiers (SIDs),
    profile directory paths, account creation timestamps, last logon times, account properties,
    profile states, and user metadata for all local and domain users who have logged onto the system.
    Maintains both active and historical account data for complete user access tracking.

  forensic_value: |
    Essential for multi-user system analysis, identifying all accounts that accessed the system,
    establishing user access timelines, detecting unauthorized account creation, and correlating
    user activities with specific accounts. Critical for insider threat investigations, privilege
    escalation analysis, and determining user presence during incident timeframes. Provides
    foundational data for linking forensic artifacts to specific user accounts.

  structure: |
    ProfileList contains user SIDs as subkeys with ProfileImagePath (profile location), State
    (profile status), RefCount (usage count), and Flags (profile properties). SAM database
    stores account data including creation times, last logon times, login counts, password
    change dates, and account flags. Names subkey provides SID-to-username mappings for
    account identification and correlation.

  examples:
    - "S-1-5-21-1234567890-1234567890-1234567890-1001\\ProfileImagePath: C:\\Users\\Administrator"
    - "S-1-5-21-1234567890-1234567890-1234567890-1002\\ProfileImagePath: C:\\Users\\jdoe"
    - "State: 0 (Active profile loaded successfully)"
    - "RefCount: 1 (Profile currently in use)"
    - "Flags: 0 (Standard user profile)"
    - "Account Created: 2024-01-15 08:00:00 UTC"
    - "Last Logon: 2024-01-20 14:30:25 UTC"
    - "Login Count: 157 (total successful logons)"
    - "Names\\Administrator: S-1-5-21-xxx-500 (Built-in Administrator SID)"

  tools:
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "User Account Control Panel"
      description: "Built-in Windows user account management interface"
    - name: "SAM Parser"
      description: "Specialized tools for analyzing Security Account Manager database"
    - name: "ProfileList Parser"
      description: "Tools for analyzing user profile registry data"
    - name: "PsGetSid"
      url: "https://docs.microsoft.com/en-us/sysinternals/downloads/psgetsid"
      description: "Utility for translating between account names and SIDs"
    - name: "whoami /all"
      description: "Built-in command for current user account information"

metadata:
  windows_versions:
    - "Windows NT"
    - "Windows 2000"
    - "Windows XP"
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"
    - "Windows Server 2000"
    - "Windows Server 2003"
    - "Windows Server 2008"
    - "Windows Server 2012"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows NT 3.1"

  criticality: "high"

  investigation_types:
    - "insider-threat"
    - "privilege-escalation"
    - "timeline-analysis"
    - "lateral-movement"
    - "persistence-analysis"
    
  tags:
    - "user-accounts"
    - "profiles"
    - "sids"
    - "account-creation"
    - "unauthorized-access"
    - "user-correlation"
    - "sam-database"
    - "profile-paths"

  references:
    - title: "Microsoft Documentation: User Profiles"
      url: "https://docs.microsoft.com/en-us/windows/win32/shell/user-profiles"
      type: "official"
    - title: "Windows User Account Forensics"
      url: "https://www.forensicfocus.com/articles/windows-user-account-forensics/"
      type: "research"
    - title: "SAM Database Analysis for Digital Forensics"
      url: "https://www.sans.org/white-papers/36427/"
      type: "research"

  retention:
    default_location: "Registry hive files (SOFTWARE, SAM)"
    persistence: "Account data persists until account deletion or system reinstallation"
    volatility: "Profile states update with user sessions, account data generally stable"

  related_artifacts:
    - "sam_security"
    - "version_info"
    - "computer_name"
    - "security_policy"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"
