title: "Volume Shadow Copy Service Configuration"
category: "system"
description: "VSS settings, restore points, shadow copy storage, and backup service configuration"

paths:
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\VSS"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Control\\BackupRestore\\FilesNotToBackup"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WindowsBackup"

details:
  what: |
    Volume Shadow Copy Service (VSS) creates point-in-time copies of files and volumes
    for backup, restore operations, and data recovery. Configuration controls VSS behavior,
    restore point creation policies, storage allocation limits, file exclusions, and
    shadow copy retention settings. Manages automated backup scheduling, system restore
    capabilities, and data protection mechanisms essential for forensic data recovery.

  forensic_value: |
    Critical for forensic investigations as VSS can be disabled by attackers to prevent
    data recovery and hide malicious activity. Shadow copies contain historical file
    versions that may preserve evidence of deleted or modified files, providing crucial
    data recovery opportunities. Configuration changes reveal attempts to disable backup
    capabilities, while shadow copy analysis can recover deleted evidence and establish
    file modification timelines essential for investigation reconstruction.

  structure: |
    VSS service configuration includes startup type, dependencies, and operational parameters.
    SystemRestore contains policies for restore point creation, disk usage limits (DiskPercent),
    retention intervals (RPLifeInterval), and monitoring settings. FilesNotToBackup specifies
    file types and locations excluded from shadow copy operations with detailed exclusion
    rules and patterns for comprehensive backup management.

  examples:
    - "VSS\\Start: 3 (Manual startup - VSS available on demand)"
    - "VSS\\Start: 4 (Disabled - VSS completely unavailable)"
    - "SystemRestore\\DisableSR: 1 (System Restore disabled)"
    - "DiskPercent: 15 (15% maximum disk space allocation for restore points)"
    - "RPLifeInterval: 7776000 (90 days restore point retention)"
    - "FilesNotToBackup: *.tmp, pagefile.sys, hiberfil.sys (Excluded file patterns)"
    - "CreateRestorePoint: 0 (Automatic restore point creation disabled)"
    - "WindowsBackup\\LastSuccessfulBackupTime: [FILETIME] (Last backup timestamp)"

  tools:
    - name: "vssadmin.exe"
      description: "Built-in Volume Shadow Copy administrative command-line tool"
    - name: "System Restore (rstrui.exe)"
      description: "Built-in Windows system restore and recovery interface"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "ShadowExplorer"
      url: "https://www.shadowexplorer.com"
      description: "Third-party tool for browsing and extracting shadow copy data"
    - name: "VSS Data Recovery Tools"
      description: "Specialized forensic tools for shadow copy analysis and data extraction"

metadata:
  windows_versions:
    - "Windows XP"
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"
    - "Windows Server 2003"
    - "Windows Server 2008"
    - "Windows Server 2012"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows XP"

  criticality: "high"

  investigation_types:
    - "timeline-analysis"
    - "data-exfiltration"
    - "incident-response"
    - "behavioral-analysis"

  tags:
    - "vss"
    - "shadow-copies"
    - "restore-points"
    - "data-recovery"
    - "evidence-preservation"
    - "backup-service"
    - "file-history"

  references:
    - title: "Microsoft Documentation: Volume Shadow Copy Service"
      url: "https://docs.microsoft.com/en-us/windows/win32/vss/volume-shadow-copy-service-overview"
      type: "official"
    - title: "Shadow Copy Forensics and Data Recovery"
      url: "https://www.sans.org/white-papers/33649/"
      type: "research"

  retention:
    default_location: "Registry hive files (SYSTEM, SOFTWARE), shadow copy storage"
    persistence: "Configuration persists until manually changed, shadow copies until retention expiry"
    volatility: "Shadow copies preserve historical data essential for forensic analysis"

  related_artifacts:
    - "backup_configuration"
    - "file_history"
    - "system_restore"
    - "data_recovery"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"
