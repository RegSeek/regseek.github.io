title: "Windows Telephony and Communication Services"
category: "communication"
description: "TAPI configuration, VoIP settings, messaging protocols, and communication service integration"

paths:
  - "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Telephony"
  - "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Communications"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\TapiSrv"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\\LocalSystemNetworkRestricted"

details:
  what: |
    Windows Telephony Application Programming Interface (TAPI) and communication services
    configuration encompasses VoIP integration, telephony service providers, communication
    device management, messaging protocols, and unified communication platform settings.
    Controls phone integration, voice services, messaging applications, and communication
    protocol support for enterprise and consumer communication solutions.

  forensic_value: |
    Critical for investigating unauthorized communication channels, VoIP-based data exfiltration,
    covert communication protocols, and misuse of communication services for malicious purposes.
    Shows evidence of telephony applications, communication service configurations that could
    facilitate unauthorized access, and protocol settings that might indicate command and
    control communication attempts through legitimate communication channels.

  structure: |
    Telephony configuration includes TAPI service providers, communication device registrations,
    protocol handlers, messaging service configurations, and VoIP integration settings.
    TapiSrv service controls telephony infrastructure with provider registration, device
    enumeration, and communication protocol management for comprehensive communication support.

  examples:
    - "Telephony\\Providers\\Provider0: unimdm.tsp (Universal modem TSP)"
    - "Telephony\\Providers\\Provider1: kmddsp.tsp (Kernel mode telephony provider)"
    - "Communications\\CallHistoryEnabled: 1 (Call history tracking enabled)"
    - "TapiSrv\\Start: 3 (Telephony service manual startup)"
    - "VoIPProtocols\\SIP: Enabled (Session Initiation Protocol support)"
    - "MessagingProtocols\\SMTP: smtp.company.com:587 (Email server configuration)"
    - "CommunicationApps\\Teams: Registered (Microsoft Teams integration)"
    - "PhoneIntegration: 1 (Mobile phone integration enabled)"

  tools:
    - name: "Phone and Modem Options (telephon.cpl)"
      description: "Built-in Windows telephony and modem configuration interface"
    - name: "Communication Apps Settings"
      description: "Windows communication application configuration and management"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "TAPI Browser"
      description: "Telephony API configuration analysis and service enumeration tools"
    - name: "VoIP Protocol Analyzer"
      description: "Tools for analyzing VoIP and communication protocol configurations"

metadata:
  windows_versions:
    - "Windows 95"
    - "Windows NT"
    - "Windows 2000"
    - "Windows XP"
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"
    - "Windows Server 2000"
    - "Windows Server 2003"
    - "Windows Server 2008"
    - "Windows Server 2012"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows 95 (TAPI 1.0)"

  criticality: "medium"

  investigation_types:
    - "data-exfiltration"
    - "behavioral-analysis"
    - "incident-response"
    - "lateral-movement"

  tags:
    - "communication"
    - "telephony"
    - "voip"
    - "messaging"
    - "tapi"
    - "communication-protocols"
    - "covert-channels"
    - "unified-communications"

  references:
    - title: "Microsoft Documentation: Telephony API (TAPI)"
      url: "https://docs.microsoft.com/en-us/windows/win32/tapi/telephony-application-programming-interfaces"
      type: "official"
    - title: "Windows Communication Services Security"
      url: "https://docs.microsoft.com/en-us/windows/security/"
      type: "official"
    - title: "VoIP Security and Forensics Analysis"
      url: "https://www.sans.org/white-papers/33649/"
      type: "research"

  retention:
    default_location: "Registry hive files (SOFTWARE, SYSTEM, NTUSER.DAT)"
    persistence: "Communication service configuration persists until service reconfiguration"
    volatility: "Protocol settings affect ongoing communication service security and monitoring"

  related_artifacts:
    - "network_interfaces"
    - "firewall_rules"
    - "proxy_settings"
    - "installed_programs"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"