title: "UserAssist Execution Statistics"
category: "execution"
description: "ROT13-encoded execution statistics including run count and last execution time"

paths:
  - "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist"

details:
  what: |
    Windows UserAssist tracks program execution statistics for GUI applications
    accessed through Windows Explorer, desktop, and Start menu. Stores execution
    count, last run time, session data, and focus time encoded with ROT13 obfuscation.
    Different GUIDs track different application categories and usage patterns.

  forensic_value: |
    Provides detailed execution statistics showing how many times programs were run
    and when they were last executed. Critical for establishing user behavior patterns,
    program usage frequency, and timeline analysis of application execution. Can prove
    user interaction with specific applications and reveal usage of portable/malicious tools.

  structure: |
    ROT13-encoded executable paths as value names with binary data containing
    execution count, last run time (FILETIME), session ID, and focus time.
    Multiple subkeys for different program categories and Windows versions.
    Data structure varies between Windows versions with consistent core elements.

  examples:
    - "Encoded: HRZR_PGYFRFFVAT\\{CEBTENF}\\Count"
    - "Decoded: UEME_CTLSESSION\\{PROGRAMS}\\Count"
    - "Program: notepad.exe"
    - "Run Count: 15"
    - "Last Executed: 2024-01-15 14:30:25"
    - "Focus Time: 120000ms"
    - "Session ID: 2"
    - "ROT13 Example: abgrCnq.rkr -> notepad.exe"

  tools:
    - name: "UserAssistView"
      url: "https://www.nirsoft.net/utils/userassist_view.html"
      description: "NirSoft tool for viewing and decoding UserAssist data"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry browser with UserAssist parsing"
    - name: "RegRipper"
      url: "https://github.com/keydet89/RegRipper3.0"
      description: "Registry analysis with userassist.pl plugin"
    - name: "UserAssist Parser"
      description: "Custom Python/PowerShell scripts for bulk analysis"

metadata:
  windows_versions:
    - "Windows XP"
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"

  introduced: "Windows XP"
  
  criticality: "high"

  investigation_types:
    - "timeline-analysis"
    - "behavioral-analysis"
    - "incident-response"
    - "malware-analysis"

  tags:
    - "execution"
    - "statistics"
    - "program-usage"
    - "timeline"
    - "user-behavior"
    - "rot13-encoding"
    - "gui-applications"
    - "execution-count"

  references:
    - title: "UserAssist Registry Key"
      url: "https://www.aldeid.com/wiki/Windows-userassist-keys"
      type: "research"
    - title: "Decoding UserAssist"
      url: "https://blog.didierstevens.com/2009/10/13/userassist/"
      type: "blog"
    - title: "SANS UserAssist Analysis"
      url: "https://www.sans.org/blog/windows-registry-analysis/"
      type: "research"

  retention:
    default_location: "NTUSER.DAT registry hive"
    persistence: "Survives reboots, persists per user profile"
    volatility: "Can be cleared but often persists through normal system usage"

  related_artifacts:
    - "amcache"
    - "appcompat_cache"
    - "muicache"
    - "recent_docs"
    - "jump_lists"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"