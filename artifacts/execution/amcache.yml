title: "AmCache Application Activity Cache"
category: "execution"
description: "Advanced execution tracking with SHA1 hashes, file metadata, and compilation timestamps"

paths:
  - "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\AppCompatCache\\Amcache.hve"

details:
  what: |
    AmCache.hve is a registry hive that replaced RecentFileCache.bcf in Windows 8+.
    It tracks metadata about executables, installed applications, and drivers including
    file paths, SHA1 hashes, compilation times, and detailed program information.
    The database contains InventoryApplication, InventoryApplicationFile, and 
    InventoryDriverBinary entries with rich forensic metadata.

  forensic_value: |
    Critical for proving file presence on system even if deleted. Contains SHA1 hashes
    for malware identification via VirusTotal. Shows compilation timestamps useful for
    correlating with threat actor campaigns. More detailed than ShimCache with richer metadata.
    Can identify renamed executables and track software installation patterns.

  structure: |
    Registry hive file containing multiple keys: InventoryApplication (installed programs),
    InventoryApplicationFile (executables), InventoryDriverBinary (drivers). Each entry
    includes FileID (SHA1 hash), file path, size, compilation time, program details,
    and binary version information stored in structured data format.

  examples:
    - "Path: C:\\Users\\user\\Desktop\\malware.exe"
    - "SHA1: 9c07abbdd1faa019708cfb54a778748077fe13e3"
    - "CompileTime: 2024-01-10 15:30:45"
    - "Size: 1,048,576 bytes"
    - "Publisher: Unknown Publisher"
    - "Product: Suspicious Application"
    - "BinaryType: 64-bit"
    - "Language: English (United States)"

  tools:
    - name: "AmcacheParser"
      url: "https://github.com/EricZimmerman/AmcacheParser"
      description: "Eric Zimmerman's AmCache parser with timeline output"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry browser and analysis tool"
    - name: "RegRipper"
      url: "https://github.com/keydet89/RegRipper3.0"
      description: "Registry analysis framework with AmCache plugins"
    - name: "KAPE"
      url: "https://www.kroll.com/en/services/cyber-risk/investigate-and-respond/kroll-artifact-parser-extractor-kape"
      description: "Artifact collection and parsing framework"

metadata:
  windows_versions:
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"
    - "Windows Server 2012"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows 8"
  
  criticality: "high"

  investigation_types:
    - "malware-analysis"
    - "timeline-analysis"
    - "incident-response"
    - "behavioral-analysis"

  tags:
    - "execution"
    - "amcache"
    - "sha1-hashes"
    - "malware-analysis"
    - "compilation-time"
    - "file-presence"
    - "application-tracking"
    - "forensic-timeline"

  references:
    - title: "Windows AmCache Analysis"
      url: "https://www.mandiant.com/resources/blog/amcache"
      type: "research"
    - title: "AmCache.hve in Windows 8"
      url: "https://www.swiftforensics.com/2013/12/amcachehve-in-windows-8-goldmine-for.html"
      type: "blog"
    - title: "SANS AmCache Analysis"
      url: "https://www.sans.org/blog/amcache-still-rules-everything-around-me-updated/"
      type: "research"

  retention:
    default_location: "Registry hive file (Amcache.hve)"
    persistence: "Survives reboots and system cleaning, persists until hive corruption"
    volatility: "Entries can be overwritten but historical data often recoverable"

  related_artifacts:
    - "appcompat_cache"
    - "userassist"
    - "prefetch_settings"
    - "muicache"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"
