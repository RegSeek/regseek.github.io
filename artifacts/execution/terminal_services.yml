title: "Terminal Services and Remote Desktop Configuration"
category: "execution"
description: "Terminal Services session management, RDP settings, and remote execution configuration"

paths:
  - "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Terminal Server\\Install"
  - "HKCU\\Software\\Microsoft\\Terminal Server Client"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server"

details:
  what: |
    Terminal Services configuration for remote desktop sessions, console sessions,
    and multi-user environments. Controls session behavior, timeouts, security
    settings, application execution in terminal sessions, RDP connection parameters,
    and remote access policies. Manages both incoming remote connections and
    outgoing Terminal Services client configurations.

  forensic_value: |
    Shows remote session configuration that could facilitate unauthorized access,
    reveals session policies that might hide user activity, indicates terminal
    services usage for remote command execution, persistence, or lateral movement.
    Critical for identifying unauthorized remote access, RDP-based attacks, and
    evidence of remote administration activities that could indicate compromise.

  structure: |
    WinStations configuration includes session settings, security descriptors,
    connection parameters, and RDP-specific settings. Install settings control
    application compatibility in multi-user environments. Client settings track
    connection preferences, recently connected servers, and authentication methods.

  examples:
    - "RDP-Tcp\\PortNumber: 3389 (default RDP port)"
    - "RDP-Tcp\\SecurityLayer: 1 (RDP security layer)"
    - "RDP-Tcp\\UserAuthentication: 1 (Network Level Authentication)"
    - "Console\\LogonId: 0 (console session identifier)"
    - "fDenyTSConnections: 0 (RDP connections allowed)"
    - "Software\\Install Mode: Install (application install mode)"
    - "Client\\LocalResourceMap: 7 (clipboard, drives, printers)"
    - "MaxConnectionTime: 0 (unlimited connection time)"
    - "MaxDisconnectionTime: 600000 (10 minutes)"
    - "EnableTimeZoneRedirection: 1"

  tools:
    - name: "Terminal Services Configuration"
      description: "Windows Terminal Services Configuration Manager"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry browser for Terminal Services analysis"
    - name: "qwinsta.exe"
      description: "Windows query session utility for active session enumeration"
    - name: "Remote Desktop Connection Manager"
      url: "https://docs.microsoft.com/en-us/sysinternals/downloads/rdcman"
      description: "Microsoft RDCMan for remote desktop connection management"
    - name: "TSAdmin"
      description: "Terminal Services administration and monitoring tools"

metadata:
  windows_versions:
    - "Windows NT 4.0 Terminal Server Edition"
    - "Windows 2000 Server"
    - "Windows XP"
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"
    - "Windows Server 2003"
    - "Windows Server 2008"
    - "Windows Server 2012"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows NT 4.0 Terminal Server Edition"
  
  criticality: "medium"

  investigation_types:
    - "lateral-movement"
    - "incident-response"
    - "behavioral-analysis"
    - "privilege-escalation"

  tags:
    - "execution"
    - "terminal-services"
    - "remote-sessions"
    - "rdp"
    - "session-management"
    - "remote-execution"
    - "lateral-movement"
    - "remote-access"
    - "multi-user"

  references:
    - title: "Remote Desktop Services"
      url: "https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/welcome-to-rds"
      type: "official"
    - title: "Terminal Services Security"
      url: "https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc754344(v=ws.11)"
      type: "official"
    - title: "RDP Security Analysis"
      url: "https://www.sans.org/blog/rdp-security-analysis/"
      type: "research"
    - title: "Terminal Services Forensics"
      url: "https://www.forensicfocus.com/articles/terminal-services-forensics/"
      type: "research"

  retention:
    default_location: "Registry hives (SYSTEM, NTUSER.DAT)"
    persistence: "Survives reboots, persists until configuration changes"
    volatility: "Session configuration preserved across reboots and reconnections"

  related_artifacts:
    - "remote_assistance"
    - "network_interfaces"
    - "user_profiles"
    - "sam_security"
    - "event_log_config"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"
