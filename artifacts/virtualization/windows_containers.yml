title: "Windows Containers and Container Runtime"
category: "virtualization"
description: "Docker Desktop configuration, Windows container settings, container runtime policies, and isolation modes"

paths:
  - "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Container Manager"
  - "HKCU\\Software\\Docker Inc\\Docker Desktop"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\containerd"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Containers"

details:
  what: |
    Windows container infrastructure encompasses Docker Desktop configuration, Windows container
    runtime settings, container isolation policies, image management, networking configuration,
    and security boundaries. Controls container execution environment, resource allocation,
    network isolation, storage management, and container-to-host communication for modern
    application deployment and microservices architecture.

  forensic_value: |
    Critical for investigating containerized malware, container escape attempts, unauthorized
    container deployments, and container-based data exfiltration. Shows evidence of container
    usage that could hide malicious activity, reveals container configurations that may facilitate
    advanced persistent threats, and indicates attempts to bypass security controls through
    container isolation weaknesses or privilege escalation techniques.

  structure: |
    Container configuration includes runtime policies, isolation modes (process vs. Hyper-V),
    network settings, storage drivers, security contexts, and resource constraints. Docker
    Desktop settings control daemon configuration, experimental features, resource allocation,
    and development environment preferences. Service configuration manages container runtime
    behavior and system integration.

  examples:
    - "ContainerManager\\IsolationMode: 1 (Process isolation enabled)"
    - "containerd\\Start: 3 (Container runtime service - manual startup)"
    - "Docker Desktop\\Settings\\SharedDrives: C,D (Host drive mapping)"
    - "Docker Desktop\\ExperimentalFeatures: true (Experimental features enabled)"
    - "Containers\\Runtime: Docker (Container runtime provider)"
    - "NetworkingMode: NAT (Network Address Translation mode)"
    - "StorageDriver: windowsfilter (Windows container storage driver)"
    - "SecurityOptions: privileged (Privileged container execution allowed)"

  tools:
    - name: "Docker Desktop"
      description: "Docker Desktop for Windows container management interface"
    - name: "docker.exe"
      description: "Docker command-line interface for container operations"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "Container Security Scanner"
      description: "Tools for analyzing container security configuration and vulnerabilities"
    - name: "Windows Container Host Analyzer"
      description: "Utilities for examining Windows container host configuration"

metadata:
  windows_versions:
    - "Windows 10 Enterprise"
    - "Windows 10 Professional"
    - "Windows 11 Enterprise"
    - "Windows 11 Professional"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows Server 2016"

  criticality: "high"

  investigation_types:
    - "malware-analysis"
    - "incident-response"
    - "privilege-escalation"
    - "behavioral-analysis"
    - "lateral-movement"

  tags:
    - "virtualization"
    - "containers"
    - "docker"
    - "container-security"
    - "isolation"
    - "runtime-security"
    - "container-escape"
    - "microservices"

  references:
    - title: "Microsoft Documentation: Windows Containers"
      url: "https://docs.microsoft.com/en-us/virtualization/windowscontainers/"
      type: "official"
    - title: "Docker Desktop for Windows"
      url: "https://docs.docker.com/desktop/windows/"
      type: "official"
    - title: "Container Security and Forensic Analysis"
      url: "https://www.sans.org/white-papers/36240/"
      type: "research"

  retention:
    default_location: "Registry hive files (SOFTWARE, SYSTEM, NTUSER.DAT)"
    persistence: "Container configuration persists until service modification"
    volatility: "Container settings affect ongoing application security and isolation"

  related_artifacts:
    - "hyperv"
    - "virtualization_security"
    - "docker_runtime"
    - "container_networking"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-06-07"
  last_updated: "2025-06-07"
  version: "1.0"
