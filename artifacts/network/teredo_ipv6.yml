title: "Teredo and IPv6 Transition Configuration"
category: "network"
description: "IPv6 transition technologies, Teredo tunneling, dual-stack configuration, and covert communication channels"

paths:
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\Teredo\\Parameters"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\IPHTTPS\\Parameters"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\iphlpsvc\\Parameters\\Isatap"

details:
  what: |
    IPv6 transition technology configuration manages Teredo tunneling, 6to4 automatic tunneling,
    ISATAP (Intra-Site Automatic Tunnel Addressing Protocol), and IP-HTTPS settings that enable
    IPv6 connectivity over IPv4 networks. Controls tunnel server addresses, interface parameters,
    transition mechanism enablement, and dual-stack network configuration for seamless IPv4/IPv6
    interoperability in mixed network environments.

  forensic_value: |
    Critical for detecting covert communication channels that exploit IPv6 transition technologies
    to bypass firewall restrictions and network monitoring. Teredo and other tunneling protocols
    can be abused for command and control communication, data exfiltration, and firewall evasion.
    Configuration changes may indicate sophisticated attack techniques using IPv6 tunnels for
    stealth communication or attempts to establish persistent backdoor channels.

  structure: |
    Teredo configuration includes Type (client/server mode), ServerName (tunnel server address),
    ClientPort (client communication port), and EnabledState (service status). IPv6 parameters
    control DisabledComponents (IPv6 feature disabling), transition technology enablement, and
    interface configurations. IP-HTTPS and ISATAP contain tunnel-specific settings and server configurations.

  examples:
    - "Teredo\\Type: 4 (Teredo client mode)"
    - "Teredo\\ServerName: teredo.ipv6.microsoft.com (Default Microsoft server)"
    - "Teredo\\ClientPort: 0 (Dynamic port allocation)"
    - "DisabledComponents: 0xFF (IPv6 completely disabled)"
    - "6to4\\Enabled: 1 (6to4 automatic tunneling enabled)"
    - "ISATAP\\Enabled: 1 (ISATAP tunneling enabled)"
    - "IPHTTPS\\State: 3 (IP-HTTPS enabled and active)"
    - "Teredo\\ServerName: malicious-tunnel.evil.com (Suspicious server)"

  tools:
    - name: "netsh interface teredo"
      description: "Built-in Teredo configuration and status commands"
    - name: "netsh interface ipv6"
      description: "IPv6 interface configuration and troubleshooting utilities"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "IPv6 Network Configuration"
      description: "Windows built-in IPv6 configuration interface"
    - name: "IPv6 Tunnel Analysis Tools"
      description: "Specialized network analysis tools for IPv6 transition technologies"

metadata:
  windows_versions:
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"
    - "Windows Server 2008"
    - "Windows Server 2012"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows Vista"

  criticality: "high"

  investigation_types:
    - "lateral-movement"
    - "data-exfiltration"
    - "behavioral-analysis"
    - "incident-response"

  tags:
    - "ipv6"
    - "teredo"
    - "tunneling"
    - "covert-communication"
    - "firewall-bypass"
    - "transition-technologies"
    - "dual-stack"

  references:
    - title: "Microsoft Documentation: IPv6 Transition Technologies"
      url: "https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/dd379548(v=ws.10)"
      type: "official"
    - title: "IPv6 Tunnel Abuse for Covert Channels"
      url: "https://www.sans.org/white-papers/33649/"
      type: "research"

  retention:
    default_location: "Registry hive files (SYSTEM)"
    persistence: "Network tunnel configuration persists across reboots"
    volatility: "Tunnel settings enable ongoing covert communication capabilities"

  related_artifacts:
    - "network_interfaces"
    - "firewall_rules"
    - "proxy_settings"
    - "dns_cache"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"
