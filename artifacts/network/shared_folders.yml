title: "Windows File Shares and SMB Configuration"
category: "network"
description: "Shared folders, SMB settings, network file sharing configuration, and access control policies"

paths:
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\lanmanserver\\Shares"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Services\\lanmanserver\\Parameters"

details:
  what: |
    Windows Server Message Block (SMB/CIFS) file sharing configuration encompasses shared folder
    definitions, access permissions, security descriptors, server parameters, workstation settings,
    and network file sharing policies. Manages both administrative shares (C$, ADMIN$) and
    user-defined shares with comprehensive access control, authentication requirements, and
    network security settings for enterprise file sharing infrastructure.

  forensic_value: |
    Critical for investigating lateral movement techniques, data exfiltration through network shares,
    and unauthorized file access in enterprise environments. Shows evidence of shared folders used
    for data staging, reveals SMB configuration vulnerabilities exploited by attackers, and indicates
    network shares accessible for unauthorized data access. Essential for analyzing advanced
    persistent threats that leverage legitimate file sharing for stealth operations.

  structure: |
    Shares registry subkey contains individual share configurations with UNC paths, security
    descriptors, access permissions, and share properties. Server parameters control SMB behavior,
    authentication requirements, security signing, and session management. Workstation parameters
    manage client-side SMB configuration and security settings for network resource access.

  examples:
    - "Shares\\\\ADMIN$: C:\\\\ (Hidden administrative share - full system access)"
    - "Shares\\\\C$: C:\\\\ (Hidden drive share - root filesystem access)"
    - "Shares\\\\SharedDocs: C:\\\\Users\\\\Public\\\\Documents (Public document share)"
    - "Shares\\\\Confidential: C:\\\\Sensitive\\\\Data (Custom sensitive data share)"
    - "RequireSecuritySignature: 1 (SMB signing required for security)"
    - "EnableSecuritySignature: 1 (SMB signing enabled)"
    - "NullSessionShares: COMCFG,DFS$ (Shares accessible without authentication)"
    - "RestrictNullSessAccess: 0 (Allow null session access - security risk)"

  tools:
    - name: "Computer Management (compmgmt.msc)"
      description: "Built-in Windows shared folder management interface"
    - name: "net share"
      description: "Command-line utility for share enumeration and management"
    - name: "ShareEnum"
      url: "https://docs.microsoft.com/en-us/sysinternals/downloads/shareenum"
      description: "Microsoft Sysinternals tool for network share discovery"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "SMB Security Scanner"
      description: "Third-party tools for SMB security assessment and vulnerability analysis"

metadata:
  windows_versions:
    - "Windows NT"
    - "Windows 2000"
    - "Windows XP"
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"
    - "Windows Server 2000"
    - "Windows Server 2003"
    - "Windows Server 2008"
    - "Windows Server 2012"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows NT 3.1"

  criticality: "high"

  investigation_types:
    - "lateral-movement"
    - "data-exfiltration"
    - "incident-response"
    - "behavioral-analysis"
    - "malware-analysis"
    
  tags:
    - "network"
    - "file-shares"
    - "smb"
    - "lateral-movement"
    - "data-exfiltration"
    - "network-exposure"
    - "cifs"

  references:
    - title: "Microsoft Documentation: SMB File Sharing"
      url: "https://docs.microsoft.com/en-us/windows-server/storage/file-server/"
      type: "official"
    - title: "SMB Security and Lateral Movement"
      url: "https://attack.mitre.org/techniques/T1021/002/"
      type: "research"
    - title: "Windows File Share Security Analysis"
      url: "https://www.sans.org/white-papers/33492/"
      type: "research"

  retention:
    default_location: "Registry hive files (SYSTEM)"
    persistence: "Share configuration persists until manually removed or server reconfiguration"
    volatility: "Network share settings affect ongoing file access and lateral movement capabilities"

  related_artifacts:
    - "mapped_drives"
    - "netbios_settings"
    - "network_interfaces"
    - "security_policy"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"
