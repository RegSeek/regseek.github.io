title: "Remote Assistance and Remote Desktop Settings"
category: "network"
description: "RDP configuration, remote assistance settings, terminal services, and remote access security"

paths:
  - "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server"
  - "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services"
  - "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Remote Assistance"
  - "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System"

details:
  what: |
    Remote Desktop Protocol (RDP) and Remote Assistance configuration encompasses service enablement,
    port settings, authentication requirements, encryption levels, connection permissions, session
    management, and security policies for remote system access. Controls terminal services behavior,
    remote assistance capabilities, Network Level Authentication, and multi-session management
    for comprehensive remote access functionality.

  forensic_value: |
    Critical for investigating unauthorized remote access, lateral movement techniques, and
    persistent backdoor installations. Shows if remote access was enabled for malicious connections,
    reveals RDP configuration changes facilitating attacker persistence, and indicates remote
    assistance sessions that could be used for data theft or system reconnaissance. Essential
    for detecting advanced persistent threats using legitimate remote access tools for stealth.

  structure: |
    Terminal Server settings include fDenyTSConnections (RDP enable/disable), PortNumber (listening port),
    SecurityLayer (authentication method), UserAuthentication (Network Level Authentication requirement),
    and MaxInstanceCount (concurrent sessions). Remote Assistance contains AllowToGetHelp (service
    enablement), MaxTicketExpiry (session timeout), and CreateEncryptedOnlyTickets (security requirements).

  examples:
    - "fDenyTSConnections: 0 (Remote Desktop enabled - potential security risk)"
    - "PortNumber: 3389 (Standard RDP port - commonly targeted)"
    - "PortNumber: 443 (Non-standard RDP port - potential evasion technique)"
    - "SecurityLayer: 2 (TLS 1.0 authentication required)"
    - "UserAuthentication: 1 (Network Level Authentication enabled)"
    - "AllowToGetHelp: 1 (Remote Assistance enabled)"
    - "MaxTicketExpiry: 6 (6-hour session timeout)"
    - "CreateEncryptedOnlyTickets: 1 (Require encryption for assistance)"

  tools:
    - name: "Remote Desktop Configuration"
      description: "Windows built-in RDP settings and configuration interface"
    - name: "Terminal Services Configuration (tsconfig.msc)"
      description: "Advanced terminal services management console"
    - name: "Registry Explorer"
      url: "https://ericzimmerman.github.io/#!index.md"
      description: "Advanced registry analysis and browsing tool"
    - name: "Remote Desktop Connection Manager"
      description: "Microsoft tool for managing multiple RDP connections"
    - name: "RDP Security Scanner"
      description: "Third-party tools for assessing RDP security configuration"

metadata:
  windows_versions:
    - "Windows XP"
    - "Windows Vista"
    - "Windows 7"
    - "Windows 8"
    - "Windows 8.1"
    - "Windows 10"
    - "Windows 11"
    - "Windows Server 2003"
    - "Windows Server 2008"
    - "Windows Server 2012"
    - "Windows Server 2016"
    - "Windows Server 2019"
    - "Windows Server 2022"

  introduced: "Windows XP"

  criticality: "high"

  investigation_types:
    - "behavioral-analysis"
    - "lateral-movement"
    - "incident-response"
    - "persistence-analysis"
    - "privilege-escalation"

  tags:
    - "rdp"
    - "remote-assistance"
    - "remote-access"
    - "lateral-movement"
    - "unauthorized-access"
    - "terminal-services"
    - "network-security"

  references:
    - title: "Microsoft Documentation: Remote Desktop Services"
      url: "https://docs.microsoft.com/en-us/windows-server/remote/remote-desktop-services/"
      type: "official"
    - title: "RDP Attacks and Lateral Movement"
      url: "https://attack.mitre.org/techniques/T1021/001/"
      type: "research"

  retention:
    default_location: "Registry hive files (SYSTEM, SOFTWARE)"
    persistence: "Remote access configuration persists until manually changed"
    volatility: "Critical security settings affecting remote access capabilities"

  related_artifacts:
    - "network_interfaces"
    - "firewall_rules"
    - "user_accounts"
    - "security_policy"

author:
  name: "Tonmoy Jitu"
  github: "tonmoy0010"
  x: "tonmoy0010"

contribution:
  date_added: "2025-01-15"
  last_updated: "2025-01-15"
  version: "2.0"
